# STM32 簡易オシロスコープ ソフトウェア設計

## ハードウェアブロック図

## 開発環境

## サンプリング機能
タイマー割り込みをトリガにしてAD変換

AD変換データをDMAでRAMに転送

RAMはxxx byte。サーキュラモードでDMA転送数を自動的にリロードすることで、リングバッファのように機能する。

## 立ち上がりエッジトリガ機能
ADCのアナログウォッチドッグ機能を利用

高閾値の割り込みルーチンで、サンプリング用タイマ停止用のタイマを起動

タイマ割り込みルーチンでサンプリング用タイマを停止

## ディスプレイ表示機能
メインループで一定周期（約10Hz）で画面を更新。

TFT液晶モジュールへのRGBデータ送信はSPIだが、1ドットずつソフトウェアでSPIデータレジスタに書き込む方法だと時間がかかる。そのため、画面全体のRGBデータを一旦RAM上で作成し、DMAでSPIデータレジスタに転送する。ただし、画面全体(320x240)のRGBデータはRAM容量(96KB)に収まらないため、画面を10分割する。
